--shows ips of attackContext

select c.id as contextID, source.ip as source, target.ip as target from alertContext c, hasTarget t, hasSource s, ip target, ip source WHERE c.id = t.alertcontext AND c.id=s.alertContext AND s.source = source.id and t.target = target.id;

-- delete alerts and corresponding contexts
TRUNCATE TABLE alert RESTART IDENTITY CASCADE;
TRUNCATE TABLE alertcontext RESTART IDENTITY CASCADE;

-- attack path
SELECT a1.id AS alertContextFromID, a2.id AS alertContextToId 
FROM alertContext a1, alertContext a2, hasSource s, hasTarget t 
WHERE s.alertContext = a1.id AND t.alertContext = a2.id AND
s.source = t.target;
